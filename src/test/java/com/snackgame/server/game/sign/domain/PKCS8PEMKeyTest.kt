@file:Suppress("NonAsciiCharacters")

package com.snackgame.server.game.sign.domain

import org.assertj.core.api.Assertions.assertThat
import org.junit.jupiter.api.Test

class PKCS8PEMKeyTest {

    @Test
    fun `PKCS#8 형식의 PEM 키를 프라이빗 키로 변환한다`() {
        val pemKey = PKCS8PEMKey(RAW_PKCS8_PEM)

        val privateKey = pemKey.toPrivateKey()

        assertThat(privateKey.encoded).isEqualTo(KEY_IN_BYTES)
    }

    companion object {
        private const val RAW_PKCS8_PEM = """-----BEGIN PRIVATE KEY-----
MIIEuwIBADANBgkqhkiG9w0BAQEFAASCBKUwggShAgEAAoIBAQC92qcfpwgUADIL
QjRgrYddJYOQrapgEW7UDrrcizJ11di36VdAnAeQhfFKPEnZ+Khq2XGJXl5CKCql
aWJl1XhxkJtFQtBHzVPg/TkrpMb2Zym9ySjHnkTFObllh5GqFU2J573vwWAHm81s
RtADcYje4+l6UMWgD3P+4JVXerheGtq8I4Kdp+ePujg3Myzkjr7mdBvTD3R4VU6s
FBcxDg4OkDc0DDZRvBJ+nzVjt7pALiOvskYeKoqWYTHXpOMzeh+siWoijv7BSlFH
L53qjv2orhOKA1ugwxoxjJ2rw5rfJMy1gyuevXzsC9wXE6Z5pxKskf7V5K6eSgwC
TV1OwRBtAgMBAAECggEAYtkXLqm+0PsREz+TGcr/sYW4rHlfPcmV1J8et3lZ+nQu
9AJvxVn3rk2uxaICKZUHyyoPrSAPH47eNWVbL/4nSamqzjLtUpUbWQc+3vRaCyzH
VOMJcnV7BNz7JFujgdS5nFWmVNBv+UYrfHaaE1DnnHU5uM+ZNa8WC9xOpU9l8shO
uHmrBSFWfs3bhg9MA4PBKyam6I5VrYTu2I0NUKg7/pqiNPjLc0oOFQfTcbFF/bBQ
EFDo7KQuN8kQ6eNSt0ap0c17NP+kzvRbsx8pHJLDGdDpPMhAfR/HAkjYDHi3tGu0
gOdXGEKeeBMvOcuaXnt6lHnO6Sp7Lvn6sBUlw4ixAQKBgQDol6sgeKsGmfLYVSQh
tMI75zBGOeL+M0ElOrAqQtcXxkdtQA9vMRL2MMby1vx3Q/dL+nla6hLrsP7vYs6W
zohmwkPpKFOwjancDuzwAGPW5Oe7hSM1wgS9GmDulrlBrjlTVhwMYMAS9CrQ9s+6
HYNImJH6Qy/9wRixrFiOLWxmDQKBgQDQ9egoxkI4NoXM4T4J65KtaM+12o5aTTjN
Itri0cDtjuSf4c8Ryq+NayKbKGNGWqc/LXMwVbXL+KP9vc33U5pmbeKsZfYHZ1cX
97uK8KqqjJYcIu80EcnfF9yqSSWgSomqKg+wIhzfuOAxhDURLnc9NjGJ9cX1gDpr
HGImzJgb4QKBgQDUwN8kjZwLJsiuv3qUZk6BEuDia9LJqMJ/Nmar0YYEVjdBpKY5
lE7+6PEicipvQbk0Q4G7+n6iHr2i5OOJqJO2Qx5xaJTc20gzZWevxPuONsYNjiP9
6WICQ93EgBQnEyGWrB5t6BXpgHSlvg2W9aX/wqdMnyaH25gl9TrvmnccBQJ/K0K9
zbM+AmVHTiNTtLoQo9YPKpcU4Z0bJV0R8+N5DbWHn5IgTI6pyZ1kjLrP0sDx3yKJ
tngIKzJOwTmKaqnkTVBynT5+sQmz/kJLkXhB3Q0+BpU08JK+OHG4PYjnQUgtOA19
MfneAHNF9vpoAiaciQ+vMeCwGyNw9LvrlhzFYQKBgHflIhIL1OW+hRTM6c6eJAyd
/kWWhBFasIoKIvEM4xpL/z1fHQOcOf3yRXlvGdE3b1N/a5zbFTk1ne1Vvrz38vDI
KKCh/vU8KGYKqgdHosOY8OuDtdoeuOK1mALzGISmOEg6SsmIhieRVD+L8/tyPBGm
xC/YpPH8UAOqabX6ggSu
-----END PRIVATE KEY-----
"""
        val KEY_IN_BYTES = """
308204bb020100300d06092a864886f70d0101010500048204a5308204a1020100
0282010100bddaa71fa7081400320b423460ad875d258390adaa60116ed40ebad
c8b3275d5d8b7e957409c079085f14a3c49d9f8a86ad971895e5e42282aa56962
65d57871909b4542d047cd53e0fd392ba4c6f66729bdc928c79e44c539b96587
91aa154d89e7bdefc160079bcd6c46d0037188dee3e97a50c5a00f73fee09557
7ab85e1adabc23829da7e78fba3837332ce48ebee6741bd30f7478554eac1417
310e0e0e9037340c3651bc127e9f3563b7ba402e23afb2461e2a8a966131d7a4
e3337a1fac896a228efec14a51472f9dea8efda8ae138a035ba0c31a318c9dab
c39adf24ccb5832b9ebd7cec0bdc1713a679a712ac91fed5e4ae9e4a0c024d5d
4ec1106d02030100010282010062d9172ea9bed0fb11133f9319caffb185b8ac
795f3dc995d49f1eb77959fa742ef4026fc559f7ae4daec5a202299507cb2a0f
ad200f1f8ede35655b2ffe2749a9aace32ed52951b59073edef45a0b2cc754e3
0972757b04dcfb245ba381d4b99c55a654d06ff9462b7c769a1350e79c7539b8
cf9935af160bdc4ea54f65f2c84eb879ab0521567ecddb860f4c0383c12b26a6
e88e55ad84eed88d0d50a83bfe9aa234f8cb734a0e1507d371b145fdb0501050
e8eca42e37c910e9e352b746a9d1cd7b34ffa4cef45bb31f291c92c319d0e93c
c8407d1fc70248d80c78b7b46bb480e75718429e78132f39cb9a5e7b7a9479ce
e92a7b2ef9fab01525c388b10102818100e897ab2078ab0699f2d8552421b4c2
3be7304639e2fe3341253ab02a42d717c6476d400f6f3112f630c6f2d6fc7743
f74bfa795aea12ebb0feef62ce96ce8866c243e92853b08da9dc0eecf00063d6
e4e7bb852335c204bd1a60ee96b941ae3953561c0c60c012f42ad0f6cfba1d83
489891fa432ffdc118b1ac588e2d6c660d02818100d0f5e828c642383685cce1
3e09eb92ad68cfb5da8e5a4d38cd22dae2d1c0ed8ee49fe1cf11caaf8d6b229b
2863465aa73f2d733055b5cbf8a3fdbdcdf7539a666de2ac65f607675717f7bb
8af0aaaa8c961c22ef3411c9df17dcaa4925a04a89aa2a0fb0221cdfb8e03184
35112e773d363189f5c5f5803a6b1c6226cc981be102818100d4c0df248d9c0b
26c8aebf7a94664e8112e0e26bd2c9a8c27f3666abd18604563741a4a639944e
fee8f122722a6f41b9344381bbfa7ea21ebda2e4e389a893b6431e716894dcdb
48336567afc4fb8e36c60d8e23fde9620243ddc4801427132196ac1e6de815e9
8074a5be0d96f5a5ffc2a74c9f2687db9825f53aef9a771c05027f2b42bdcdb3
3e0265474e2353b4ba10a3d60f2a9714e19d1b255d11f3e3790db5879f92204c
8ea9c99d648cbacfd2c0f1df2289b678082b324ec1398a6aa9e44d50729d3e7e
b109b3fe424b917841dd0d3e069534f092be3871b83d88e741482d380d7d31f9
de007345f6fa6802269c890faf31e0b01b2370f4bbeb961cc56102818077e522
120bd4e5be8514cce9ce9e240c9dfe459684115ab08a0a22f10ce31a4bff3d5f
1d039c39fdf245796f19d1376f537f6b9cdb1539359ded55bebcf7f2f0c828a0
a1fef53c28660aaa0747a2c398f0eb83b5da1eb8e2b59802f31884a638483a4a
c988862791543f8bf3fb723c11a6c42fd8a4f1fc5003aa69b5fa8204ae"""
            .replace("\n", "")
            .chunked(2)
            .map { it.toInt(16).toByte() }
            .toByteArray()
    }
}
